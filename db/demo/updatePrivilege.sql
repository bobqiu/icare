ALTER TABLE T_ROLE_PRIVILEGES
DROP CONSTRAINT fk_ROLE_PRIVILEGES_privilege_id
GO

DROP TABLE T_PRIVILEGE
go

CREATE TABLE T_PRIVILEGE
(
	id					int				PRIMARY KEY IDENTITY,
	name				nvarchar(50)	NOT NULL,				--权限名
	parent_id			int				NOT NULL,				--父亲结点，顶级菜单id为1，其父节点为虚拟结点，为0
	parent_ids			varchar(1000)	NOT NULL,				--所有父亲权限列表，用逗号分隔，从0开始。添加到索引
	permission			varchar(255)	NOT NULL,				--shiro权限字符串
	href				varchar(255)	,						--链接
	icon				varchar(100)	,						--图标
	notes				nvarchar(500)	,						--权限说明
)
GO

insert into T_PRIVILEGE(name,parent_id,parent_ids,permission,href,icon,notes)values('root',0,'0,','','','',''),('gero',0,'0,','','','',''),('staff',0,'0,','','','',''),('系统管理',1,'0,1,','','','',''),('用户管理',3,'0,1,3,','','','',''),('获取用户列表',4,'0,1,3,4,','/user#GET','/user','',''),('新增账户信息',4,'0,1,3,4,','/user#POST','','',''),('获取账户信息',4,'0,1,3,4,','/user/{uid}#GET','/user/{uid}','',''),('修改基本账户信息',4,'0,1,3,4,','/user/{uid}#PUT','','',''),('修改用户密码',4,'0,1,3,4,','/user/{uid}/password#PUT','','',''),('获取用户角色信息列表',4,'0,1,3,4,','/user/{uid}/role#GET','/user/{uid}/role','',''),('修改某个用户的角色',4,'0,1,3,4,','/user/{uid}/role#PUT','','',''),('用户删除一个角色',4,'0,1,3,4,','/user/{uid}/role/{rid}#DELETE','','',''),('删除账户信息',4,'0,1,3,4,','/user/{uid}#DELETE','','',''),('养老院的角色管理（管理员权限）',3,'0,1,3,','','','',''),('获取养老院角色列表',14,'0,1,3,14,','/gero/{gid}/role#GET','/gero/{gid}/role','',''),('新增养老院角色',14,'0,1,3,14,','/gero/{gid}/role#POST','','',''),('角色信息',14,'0,1,3,14,','/gero/{gid}/role/{rid}#GET','/gero/{gid}/role/{rid}','',''),('修改角色的基本信息',14,'0,1,3,14,','/gero/{gid}/role/{rid}#PUT','','',''),('删除养老院角色',14,'0,1,3,14,','/gero/{gid}/role/{rid}#DELETE','','',''),('给养老院角色修改权限',14,'0,1,3,14,','/gero/{gid}/role/{rid}/privilege#PUT','','',''),('默认角色管理（超级管理员）',3,'0,1,3,','','','',''),('获取默认角色列表',21,'0,1,3,21,','/role#GET','/role','',''),('增加默认角色信息',21,'0,1,3,21,','/role#POST','','',''),('获取默认角色信息',21,'0,1,3,21,','/role/{rid}#GET','/role/{rid}','',''),('修改默认角色的信息',21,'0,1,3,21,','/role/{rid}#PUT','','',''),('删除默认角色的信息',21,'0,1,3,21,','/role/{rid}#DELETE','','',''),('修改默认角色的权限',21,'0,1,3,21,','/role/{rid}/privilege#PUT','','',''),('权限管理(超级管理员)',3,'0,1,3,','','','',''),('权限列表',28,'0,1,3,28,','/privilege#GET','/privilege','',''),('新增权限',28,'0,1,3,28,','/privilege#POST','','',''),('修改权限',28,'0,1,3,28,','/privilege/{pid}#PUT','','',''),('删除权限',28,'0,1,3,28,','/privilege/{pid}#DELETE','','',''),('获取角色的权限',28,'0,1,3,28,','/role/{rid}/privilege#GET','/role/{rid}/privilege','',''),('养老院信息',1,'0,1,','','','',''),('养老院管理（超管）',34,'0,1,34,','','','',''),('获取养老院列表',35,'0,1,34,35,','/gero#GET','/gero','',''),('新增养老院基本信息',35,'0,1,34,35,','/gero#POST','','',''),('获取养老院基本信息',35,'0,1,34,35,','/gero/{gid}#GET','/gero/{gid}','',''),('修改养老院基本信息',35,'0,1,34,35,','/gero/{gid}#PUT','','',''),('删除养老院',35,'0,1,34,35,','/gero/{gid}#DELETE','','',''),('养老院区域管理',34,'0,1,34,','','','',''),('获取养老院所有的区域列表',41,'0,1,34,41,','/gero/{gid}/area#GET','/gero/{gid}/area','',''),('创建一个养老院区域',41,'0,1,34,41,','/gero/{gid}/area#POST','','',''),('获取某区域及其子区域',41,'0,1,34,41,','/gero/{gid}/area/{aid}#GET','/gero/{gid}/area/{aid}','',''),('修改某区域',41,'0,1,34,41,','/gero/{gid}/area/{aid}#PUT','','',''),('修改某区域',41,'0,1,34,41,','/gero/{gid}/area/{aid}#DELETE','','',''),('养老院房间和床位',34,'0,1,34,','','','',''),('房间信息+老人',47,'0,1,34,47,','/room/{area_id}#GET','/room/{area_id}','',''),('默认老人项目（超管）',34,'0,1,34,','','','',''),('获取老人护理项目总表',49,'0,1,34,49,','/care_item#GET','/care_item','',''),('添加老人护理项目',49,'0,1,34,49,','/care_item#POST','','',''),('获取总表中某个老人项目',49,'0,1,34,49,','/care_item/{cid}#GET','/care_item/{cid}','',''),('修改总表中某个老人项目',49,'0,1,34,49,','/care_item/{cid}#PUT','','',''),('删除总表中某个老人项目',49,'0,1,34,49,','/care_item/{cid}#DELETE','','',''),('默认房间项目（超管）',34,'0,1,34,','','','',''),('获取房间项目总表',55,'0,1,34,55,','/area_item#GET','/area_item','',''),('添加房间项目',55,'0,1,34,55,','/area_item#POST','','',''),('获取总表中某个房间项目',55,'0,1,34,55,','/area_item/{aid}#GET','/area_item/{aid}','',''),('修改总表中房间项目',55,'0,1,34,55,','/area_item/{aid}#PUT','','',''),('删除总表中某个房间项目',55,'0,1,34,55,','/area_item/{aid}#DELETE','','',''),('养老院包含的老人项目',34,'0,1,34,','','','',''),('获取养老院护理项目列表',61,'0,1,34,61,','/gero/{gid}/care_item#GET','/gero/{gid}/care_item','',''),('添加养老院护理项目',61,'0,1,34,61,','/gero/{gid}/care_item#POST','','',''),('获取某个养老院的老人项目',61,'0,1,34,61,','/gero/{gid}/care_item/{itemid}#GET','/gero/{gid}/care_item/{itemid}','',''),('修改某个养老院的老人项目',61,'0,1,34,61,','/gero/{gid}/care_item/{itemid}#PUT','','',''),('删除养老院某个老人项目',61,'0,1,34,61,','/gero/{gid}/care_item/{itemid}#DELETE','','',''),('养老院包含的房间项目',34,'0,1,34,','','','',''),('获取养老院房间项目列表',67,'0,1,34,67,','/gero/{gid}/area_item#GET','/gero/{gid}/area_item','',''),('添加养老院房间项目',67,'0,1,34,67,','/gero/{id}/area_item#POST','','',''),('获取养老院房间项目',67,'0,1,34,67,','/gero/{gid}/area_item/{aid}#GET','/gero/{gid}/area_item/{aid}','',''),('更新养老院房间项目',67,'0,1,34,67,','/gero/{gid}/area_item/{aid}#PUT','','',''),('删除养老院房间项目',67,'0,1,34,67,','/gero/{gid}/area_item/{aid}#DELETE','','',''),('老人相关',0,'0,','','','',''),('老人基本信息',73,'0,73,','','','',''),('获取老人列表',74,'0,73,74,','/gero/{gid}/elder#GET','/gero/{gid}/elder','',''),('增加老人详细信息',74,'0,73,74,','/gero/{gid}/elder/#POST','','',''),('查单个老人详细信息',74,'0,73,74,','/gero/{gid}/elder/{eid}#GET','/gero/{gid}/elder/{eid}','',''),('修改单个老人详细信息',74,'0,73,74,','/gero/{gid}/elder/{eid}#PUT','','',''),('老人离院登记',74,'0,73,74,','/gero/{gid}/elder/{eid}#DELETE','','',''),('老人表单信息',73,'0,73,','','','',''),('表单',80,'0,73,80,','/elder/{eid}/sheet#GET','/elder/{eid}/sheet','',''),('老人健康数据',73,'0,73,','','','',''),('获取老人的体温数据',82,'0,73,82,','/elder/{eid}/temperature#GET','/elder/{eid}/temperature','',''),('输入老人的体温数据',82,'0,73,82,','/elder/{eid}/temperature#POST','','',''),('获取老人的血压数据',82,'0,73,82,','/elder/{eid}/blood_pressure#GET','/elder/{eid}/blood_pressure','',''),('输入老人的血压数据',82,'0,73,82,','/elder/{eid}/blood_pressure#POST','','',''),('获取老人的心率数据',82,'0,73,82,','/elder/{eid}/heart_rate#GET','/elder/{eid}/heart_rate','',''),('获取老人的心率数据',82,'0,73,82,','/elder/{eid}/heart_rate#POST','','',''),('老人专属的项目',73,'0,73,','','','',''),('获取养老院老人的项目列表',89,'0,73,89,','/elder/{eid}/care_item#GET','/elder/{eid}/care_item','',''),('添加养老院某个老人的护理项目',89,'0,73,89,','/elder/{eid}/care_item#POST','','',''),('获取老人的某个项目',89,'0,73,89,','/elder/{eid}/care_item/{itemid}#GET','/elder/{eid}/care_item/{itemid}','',''),('修改老人的某个项目',89,'0,73,89,','/elder/{eid}/care_item/{itemid}#PUT','','',''),('删除老人某个项目',89,'0,73,89,','/elder/{eid}/care_item/{itemid}#DELETE','','',''),('员工相关',2,'0,2,','','','',''),('员工基本信息',95,'0,2,95,','','','',''),('获取员工列表',96,'0,2,95,96,','/gero/{gid}/staff#GET','/gero/{gid}/staff','',''),('新增员工信息',96,'0,2,95,96,','/gero/{gid}/staff#POST','','',''),('查询员工信息',96,'0,2,95,96,','/gero/{gid}/staff/{sid}#GET','/gero/{gid}/staff/{sid}','',''),('修改员工信息',96,'0,2,95,96,','/gero/{gid}/staff/{sid}#PUT','','',''),('员工离职',96,'0,2,95,96,','/gero/{gid}/staff/{sid}#DELETE','','',''),('老人护工的记录',95,'0,2,95,','','','',''),('获取老人护工负责的老人的项目记录列表',102,'0,2,95,102,','/carer/{cid}/elder/{eid}/records#GET','/carer/{cid}/elder/{eid}/records','',''),('添加老人护工负责的某个老人的项目记录',102,'0,2,95,102,','/carer/{cid}/elder/{eid}/records#POST','','',''),('获取老人护工的项目记录列表（所有老人）',102,'0,2,95,102,','/carer/{cid}/elder/records#GET','/carer/{cid}/elder/records','',''),('房间护工的房间记录',95,'0,2,95,','','','',''),('获取房间护工的房间项目记录列表',106,'0,2,95,106,','/carer/{cid}/area/{aid}/records#GET','/carer/{cid}/area/{aid}/records','',''),('添加房间护工的房间项目记录',106,'0,2,95,106,','/carer/{cid}/area/{aid}/records#POST','','',''),('获取房间护工的项目记录列表（所有房间）',106,'0,2,95,106,','/carer/{cid}/area/records#GET','/carer/{cid}/area/records','',''),('排班相关',2,'0,2,','','','',''),('职工上班时间安排（单个员工维度）',110,'0,2,110,','','','',''),('获取某员工的上班信息列表（批量）',111,'0,2,110,111,','/staff/{sid}/schedule#GET','/staff/{sid}/schedule','',''),('添加员工的排班信息（批量）',111,'0,2,110,111,','/staff/{sid}/schedule#POST(PUT)','','',''),('获取某员工的某天是否上班',111,'0,2,110,111,','/staff/{sid}/schedule/{date}#GET','/staff/{sid}/schedule/{date}','',''),('增加/修改员工的某一天排班信息',111,'0,2,110,111,','/staff/{sid}/schedule/{date}#POST(PUT)','','',''),('删除员工的某一天排班信息',111,'0,2,110,111,','/staff/{sid}/schedule/{date}#DELETE','','',''),('职工上排时间安排（养老院维度）',110,'0,2,110,','','','',''),('获取养老院员工排班信息',117,'0,2,110,117,','/gero/{gid}/schedule#GET','/gero/{gid}/schedule','',''),('修改养老院护工排班信息(多员工)',117,'0,2,110,117,','/gero/{gid}/schedule#PUT','','',''),('老人护工职责',110,'0,2,110,','','','',''),('获取老人护工负责的老人列表',120,'0,2,110,120,','/carer/{cid}/elder#GET','/carer/{cid}/elder','',''),('获取老人护工负责的某个老人的相关信息',120,'0,2,110,120,','/carer/{cid}/elder/{eid}/duty#GET','/carer/{cid}/elder/{eid}/duty','',''),('终止老人护工对某个老人的负责关系',120,'0,2,110,120,','/carer/{cid}/elder/{eid}/duty#DELETE','','',''),('建立老人护工对某个老人的负责关系，同时终止这个老人与其他护工的负责关系',120,'0,2,110,120,','/carer/{cid}/elder/{eid}/duty#PUT','','',''),('房间护工职责',110,'0,2,110,','','','',''),('获取房间护工负责的房间列表',125,'0,2,110,125,','/carer/{sid}/area#GET','/carer/{sid}/area','',''),('获取房间护工负责的某个房间的相关信息',125,'0,2,110,125,','/carer/{sid}/area/{aid}/duty#GET','/carer/{sid}/area/{aid}/duty','',''),('终止房间护工对某个房间的负责关系',125,'0,2,110,125,','/carer/{cid}/area/{aid}/duty#DELETE','','',''),('建立房间护工对某个房间的负责关系',125,'0,2,110,125,','/carer/{cid}/area/{aid}/duty#POST','','',''),('建立房间护工对某个房间的负责关系，同时终止这个房间与其他护工的负责关系',125,'0,2,110,125,','/carer/{cid}/area/{aid}/duty#PUT','','',''),('排班结果',110,'0,2,110,','','','',''),('获取老人的负责护工',131,'0,2,110,131,','/elder/{eid}/duty_carer#GET','/elder/{eid}/duty_carer','',''),('获取房间的负责护工',131,'0,2,110,131,','/area/{aid}/duty_carer#GET','/area/{aid}/duty_carer','','')
go

insert into T_ROLE_PRIVILEGES(role_id,privilege_id) values(1,1),(1,2),(1,3),(1,4),(1,5),(1,6),(1,7),(1,8),(1,9),(1,10),(1,11),(1,12),(1,13),(1,14),(1,15),(1,16),(1,17),(1,18),(1,19),(1,20),(1,21),(1,22),(1,23),(1,24),(1,25),(1,26),(1,27),(1,28),(1,29),(1,30),(1,31),(1,32),(1,33),(1,34),(1,35),(1,36),(1,37),(1,38),(1,39),(1,40),(1,41),(1,42),(1,43),(1,44),(1,45),(1,46),(1,47),(1,48),(1,49),(1,50),(1,51),(1,52),(1,53),(1,54),(1,55),(1,56),(1,57),(1,58),(1,59),(1,60),(1,61),(1,62),(1,63),(1,64),(1,65),(1,66),(1,67),(1,68),(1,69),(1,70),(1,71),(1,72),(1,73),(1,74),(1,75),(1,76),(1,77),(1,78),(1,79),(1,80),(1,81),(1,82),(1,83),(1,84),(1,85),(1,86),(1,87),(1,88),(1,89),(1,90),(1,91),(1,92),(1,93),(1,94),(1,95),(1,96),(1,97),(1,98),(1,99),(1,100),(1,101),(1,102),(1,103),(1,104),(1,105),(1,106),(1,107),(1,108),(1,109),(1,110),(1,111),(1,112),(1,113),(1,114),(1,115),(1,116),(1,117),(1,118),(1,119),(1,120),(1,121),(1,122),(1,123),(1,124),(1,125),(1,126),(1,127),(1,128),(1,129),(1,130),(1,131),(1,132),(1,133),(1,134)
go

ALTER TABLE T_ROLE_PRIVILEGES
ADD CONSTRAINT fk_ROLE_PRIVILEGES_privilege_id
FOREIGN KEY (privilege_id)
REFERENCES T_PRIVILEGE(id)
ON DELETE NO ACTION
GO