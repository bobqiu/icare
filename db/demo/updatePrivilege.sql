DROP TABLE T_ROLE_PRIVILEGES
GO

CREATE TABLE T_ROLE_PRIVILEGES
(
	id					int				PRIMARY KEY IDENTITY,
	role_id				int				NOT NULL,				--
	privilege_id		int				,						--
)
GO

DROP TABLE T_PRIVILEGE
go

CREATE TABLE T_PRIVILEGE
(
	id					int				PRIMARY KEY IDENTITY,
	name				nvarchar(50)	NOT NULL,				--权限名
	parent_id			int				NOT NULL,				--父亲结点，顶级菜单id为1，其父节点为虚拟结点，为0
	parent_ids			varchar(1000)	NOT NULL,				--所有父亲权限列表，用逗号分隔，从0开始。添加到索引
	permission			varchar(255)	NOT NULL,				--shiro权限字符串
	api					varchar(255)	NOT NULL,				--shiro权限字符串
	href				varchar(255)	,						--链接
	icon				varchar(100)	,						--图标
	notes				nvarchar(500)	,						--权限说明
)
GO

ALTER TABLE T_ROLE_PRIVILEGES
ADD CONSTRAINT fk_ROLE_PRIVILEGES_role_id
FOREIGN KEY (role_id)
REFERENCES T_ROLE(id)
ON DELETE CASCADE
GO

ALTER TABLE T_ROLE_PRIVILEGES
ADD CONSTRAINT fk_ROLE_PRIVILEGES_privilege_id
FOREIGN KEY (privilege_id)
REFERENCES T_PRIVILEGE(id)
ON DELETE CASCADE
GO

insert into T_PRIVILEGE(name,parent_id,parent_ids,permission,href,api,icon,notes)values ('root','0','0,','','','','',''),('用户','1','0,1','','','','',''),('用户个人信息','2','0,1,2','','','','',''),('查看当前用户信息','3','0,1,2,3','','','','',''),('查看当前超管信息','4','0,1,2,3,4','user:{uid}:info:read','/user/1','/user/{id}:GET','',''),('查看当前员工信息','4','0,1,2,3,4','user:{uid}:info:read','','/gero/{id}/staff/{id}:GET','',''),('查看当前老人信息','4','0,1,2,3,4','user:{uid}:info:read','','/gero/{id}/elder/{id}:GET','',''),('查看当前家属信息','4','0,1,2,3,4','user:{uid}:info:read','','','',''),('修改当前用户信息','3','0,1,2,3','','no','','',''),('修改当前超管信息','9','0,1,2,3,9','user:{uid}:info:update','','/user/{id}:PUT','',''),('修改当前员工信息','9','0,1,2,3,9','user:{uid}:info:update','','/gero/{id}/staff/{id}:PUT','',''),('修改当前老人信息','9','0,1,2,3,9','user:{uid}:info:update','','/gero/{id}/elder/{id}:PUT','',''),('修改当前家属信息','9','0,1,2,3,9','user:{uid}:info:update','','','',''),('修改用户密码','3','0,1,2,3','user:{uid}:password:update','no','/user/{id}/password:PUT','',''),('老人家属功能模块','2','0,1,2','','no','','',''),('查看老人健康信息','15','0,1,2,15','','','','',''),('查看老人体温','16','0,1,2,15,16','elder:{eid}:health:read','','/gero/{id}/elder/{id}/temperature:GET','',''),('查看老人血压','16','0,1,2,15,16','elder:{eid}:health:read','','/gero/{id}/elder/{id}/blood_pressure:GET','',''),('查看老人心律','16','0,1,2,15,16','elder:{eid}:health:read','','/gero/{id}/elder/{id}/heart_rate:GET','',''),('查看老人项目记录','15','0,1,2,15','elder:{eid}:carework_record:read','','/gero/{id}/carework_record:GET','',''),('查看老人负责护工','15','0,1,2,15','elder:{eid}:carework:read','','/gero/{id}/carework:GET','',''),('查看老人项目','15','0,1,2,15','elder:{eid}:care_item:read','','/gero/{id}/elder/{id}/care_item:GET','',''),('职工功能模块','2','0,1,2','','','','',''),('养老院信息','23','0,1,2,23','','','','',''),('查看养老院老人','24','0,1,2,23,24','staff:{sid}:gero:{gid}:elder:read','/gero/1/elder','/gero/{id}/elder/{id}:GET','',''),('查看养老院基本信息','24','0,1,2,23,24','staff:{sid}:gero:{gid}:info:read','','/gero/{id}:GET','',''),('获取养老院所有的区域列表','24','0,1,2,23,24','staff:{sid}:gero:{gid}:area:read','','/gero/{id}/area:GET','',''),('获取某区域及其子区域','24','0,1,2,23,24','staff:{sid}:gero:{gid}:area:read','','/gero/{id}/area/{id}:GET','',''),('查看本人排班信息','23','0,1,2,23','','','','',''),('获取某员工的上班信息列表','29','0,1,2,23,29','staff:{sid}:schedule:read','','/gero/{id}/staff/{id}/schedule:GET','',''),('获取某员工的某天是否上班','29','0,1,2,23,29','staff:{sid}:schedule:read','','/staff/{id}/schedule/{date}:GET','',''),('养老院管理模块','23','0,1,2,23','','','','',''),('养老院基本信息','32','0,1,2,23,32','','','','',''),('获取养老院基本信息','33','0,1,2,23,32,33','admin:gero:{gid}:info:read','','/gero/{id}:GET','',''),('修改养老院基本信息','33','0,1,2,23,32,33','admin:gero:{gid}:info:update','','/gero/{id}:PUT','',''),('区域管理','32','0,1,2,23,32','','','','',''),('获取养老院所有的区域列表','36','0,1,2,23,32,36','admin:gero:{gid}:area:read','','/gero/{id}/area:GET','',''),('创建一个养老院区域','36','0,1,2,23,32,36','admin:gero:{gid}:area:add','','/gero/{id}/area:POST','',''),('获取某区域及其子区域','36','0,1,2,23,32,36','admin:gero:{gid}:area:read','','/gero/{id}/area/{id}:GET','',''),('修改某区域','36','0,1,2,23,32,36','admin:gero:{gid}:area:update','','/gero/{id}/area/{id}:PUT','',''),('删除某区域','36','0,1,2,23,32,36','admin:gero:{gid}:area:delete','','/gero/{id}/area/{id}:DELETE','',''),('项目管理','32','0,1,2,23,32','','','','',''),('老人项目','42','0,1,2,23,32,42','','','','',''),('老人项目列表','43','0,1,2,23,32,42,43','admin:gero:{gid}:elder_item:read','/gero/1/care_item','/gero/{id}/care_item:GET','',''),('添加老人项目','43','0,1,2,23,32,42,43','admin:gero:{gid}:elder_item:add','','/gero/{id}/care_item:POST','',''),('取老人项目','43','0,1,2,23,32,42,43','admin:gero:{gid}:elder_item:read','','/gero/{id}/care_item/{id}:GET','',''),('改老人项目','43','0,1,2,23,32,42,43','admin:gero:{gid}:elder_item:update','','/gero/{id}/care_item/{id}:PUT','',''),('删老人项目','43','0,1,2,23,32,42,43','admin:gero:{gid}:elder_item:delete','','/gero/{id}/care_item/{id}:DELETE','',''),('房间项目','42','0,1,2,23,32,42','','','','',''),('房间项目列表','49','0,1,2,23,32,42,49','admin:gero:{gid}:area_item:read','/gero/1/area_item','/gero/{id}/area_item:GET','',''),('添加房间项目','49','0,1,2,23,32,42,49','admin:gero:{gid}:area_item:add','','/gero/{id}/area_item:POST','',''),('取房间项目','49','0,1,2,23,32,42,49','admin:gero:{gid}:area_item:read','','/gero/{id}/area_item/{id}:GET','',''),('改房间项目','49','0,1,2,23,32,42,49','admin:gero:{gid}:area_item:update','','/gero/{id}/area_item/{id}:PUT','',''),('删房间项目','49','0,1,2,23,32,42,49','admin:gero:{gid}:area_item:delete','','/gero/{id}/area_item/{id}:DELETE','',''),('老人专属项目','42','0,1,2,23,32,42','','no','','',''),('老人专属项目列表','55','0,1,2,23,32,42,55','admin:gero:{gid}:elder:elder_item:read','','/gero/{id}/elder/{id}/care_item:GET','',''),('添加老人专属项目','55','0,1,2,23,32,42,55','admin:gero:{gid}:elder:elder_item:add','','/gero/{id}/elder/{id}/care_item:POST','',''),('取老人专属项目','55','0,1,2,23,32,42,55','admin:gero:{gid}:elder:elder_item:read','','/gero/{id}/elder/{id}/care_item/{id}:GET','',''),('改老人专属项目','55','0,1,2,23,32,42,55','admin:gero:{gid}:elder:elder_item:update','','/gero/{id}/elder/{id}/care_item/{id}:PUT','',''),('删老人专属项目','55','0,1,2,23,32,42,55','admin:gero:{gid}:elder:elder_item:delete','','/gero/{id}/elder/{id}/care_item/{id}:DELETE','',''),('院属互动','32','0,1,2,23,32','','no','','',''),('院属互动列表','61','0,1,2,23,32,61','admin:gero:{gid}:exchange:read','','/gero/{id}/exchange:GET','',''),('添加院属互动','61','0,1,2,23,32,61','admin:gero:{gid}:exchange:add','','/gero/{id}/exchange:POST','',''),('取院属互动','61','0,1,2,23,32,61','admin:gero:{gid}:exchange:read','','/gero/{id}/exchange/{id}:GET','',''),('改院属互动','61','0,1,2,23,32,61','admin:gero:{gid}:exchange:update','','/gero/{id}/exchange/{id}:PUT','',''),('删院属互动','61','0,1,2,23,32,61','admin:gero:{gid}:exchange:delete','','/gero/{id}/exchange/{id}:DELETE','',''),('角色管理','32','0,1,2,23,32','','','','',''),('养老院角色列表','67','0,1,2,23,32,67','admin:gero:{gid}:role:read','/gero/1/role','/gero/{id}/role:GET','',''),('新增养老院角色','67','0,1,2,23,32,67','admin:gero:{gid}:role:add','','/gero/{id}/role:POST','',''),('获取角色信息','67','0,1,2,23,32,67','admin:gero:{gid}:role:read','','/gero/{id}/role/{id}:GET','',''),('修改角色的基本信息','67','0,1,2,23,32,67','admin:gero:{gid}:role:update','','/gero/{id}/role/{id}:PUT','',''),('删除养老院角色','67','0,1,2,23,32,67','admin:gero:{gid}:role:delete','','/gero/{id}/role/{id}:DELETE','',''),('给养老院角色添加权限','67','0,1,2,23,32,67','admin:gero:{gid}:role:update','','/gero/{id}/role/{id}/privilege:POST','',''),('给养老院角色删除权限','67','0,1,2,23,32,67','admin:gero:{gid}:role:update','','/gero/{id}/role/{id}/privilege:DELETE','',''),('为某个角色关联员工','67','0,1,2,23,32,67','admin:gero:{gid}:role:update','','/gero/{id}/role/{id}/user:PUT','',''),('职工基本信息管理','32','0,1,2,23,32','','','','',''),('职工基本信息列表','76','0,1,2,23,32,76','admin:gero:{gid}:staff:info:read','/gero/1/staff','/gero/{id}/staff:GET','',''),('增加职工基本信息','76','0,1,2,23,32,76','admin:gero:{gid}:staff:info:add','','/gero/{id}/staff:POST','',''),('查找职工基本信息','76','0,1,2,23,32,76','admin:gero:{gid}:staff:info:read','','/gero/{id}/staff/{id}:GET','',''),('修改职工基本信息','76','0,1,2,23,32,76','admin:gero:{gid}:staff:info:update','','/gero/{id}/staff/{id}:PUT','',''),('删除职工基本信息','76','0,1,2,23,32,76','admin:gero:{gid}:staff:info:delete','','/gero/{id}/staff/{id}:DELETE','',''),('老人基本信息管理','32','0,1,2,23,32','','','','',''),('老人基本信息列表','82','0,1,2,23,32,82','admin:gero:{gid}:elder:info:read','','/gero/{id}/elder:GET','',''),('新增老人基本信息','82','0,1,2,23,32,82','admin:gero:{gid}:elder:info:add','','/gero/{id}/elder:POST','',''),('修改老人基本信息','82','0,1,2,23,32,82','admin:gero:{gid}:elder:info:read','','/gero/{id}/elder/{id}:GET','',''),('查找老人基本信息','82','0,1,2,23,32,82','admin:gero:{gid}:elder:info:update','','/gero/{id}/elder/{id}:PUT','',''),('删除老人基本信息','82','0,1,2,23,32,82','admin:gero:{gid}:elder:info:delete','','/gero/{id}/elder/{id}:DELETE','',''),('老人健康信息管理','32','0,1,2,23,32','','','','',''),('获取体温','88','0,1,2,23,32,88','admin:gero:{gid}:elder:health:read','','/gero/{id}/elder/{id}/temperature:GET','',''),('新增体温','88','0,1,2,23,32,88','admin:gero:{gid}:elder:health:add','','/gero/{id}/elder/{id}/temperature:POST','',''),('获取血压','88','0,1,2,23,32,88','admin:gero:{gid}:elder:health:read','','/gero/{id}/elder/{id}/blood_pressure:GET','',''),('新增血压','88','0,1,2,23,32,88','admin:gero:{gid}:elder:health:add','','/gero/{id}/elder/{id}/blood_pressure:POST','',''),('获取心率','88','0,1,2,23,32,88','admin:gero:{gid}:elder:health:read','','/gero/{id}/elder/{id}/heart_rate:GET','',''),('新增心率','88','0,1,2,23,32,88','admin:gero:{gid}:elder:health:add','','/gero/{id}/elder/{id}/heart_rate:POST','',''),('项目记录管理','32','0,1,2,23,32','','','','',''),('老人护工','95','0,1,2,23,32,95','','','','',''),('老人护工的项目记录列表','96','0,1,2,23,32,95,96','admin:gero:{gid}:carework_record:read','','/gero/{id}/carework_record:GET','',''),('添加老人护工项目记录','96','0,1,2,23,32,95,96','admin:gero:{gid}:carework_record:add','','/gero/{id}/carework_record:POST','',''),('房间护工','95','0,1,2,23,32,95','','','','',''),('房间护工的项目记录列表','99','0,1,2,23,32,95,99','admin:gero:{gid}:areawork_record:read','','/gero/{id}/areawork_record:GET','',''),('添加房间护工项目记录','99','0,1,2,23,32,95,99','admin:gero:{gid}:areawork_record:add','','/gero/{id}/areawork_record:POST','',''),('排班管理','32','0,1,2,23,32','','','','',''),('上班时间安排','102','0,1,2,23,32,102','','','','',''),('上班时间安排列表','103','0,1,2,23,32,102,103','admin:gero:{gid}:schedule:read','/gero/1/schedule','/gero/{id}/schedule:GET','',''),('修改上班时间安排','103','0,1,2,23,32,102,103','admin:gero:{gid}:schedule:update','','/gero/{id}/schedule:PUT','',''),('老人护工职责','102','0,1,2,23,32,102','','no','','',''),('老人护工职责列表','106','0,1,2,23,32,102,106','admin:gero:{gid}:carework:read','','/gero/{id}/carework:GET','',''),('新增老人护工职责','106','0,1,2,23,32,102,106','admin:gero:{gid}:carework:add','','/gero/{id}/carework:POST','',''),('修改老人护工职责','106','0,1,2,23,32,102,106','admin:gero:{gid}:carework:update','','/gero/{id}/carework/{id}:PUT','',''),('删除老人护工职责','106','0,1,2,23,32,102,106','admin:gero:{gid}:carework:delete','','/gero/{id}/carework/{id}:DELETE','',''),('房间护工职责','102','0,1,2,23,32,102','','no','','',''),('房间护工职责列表','111','0,1,2,23,32,102,111','admin:gero:{gid}:areawork:read','','/gero/{id}/areawork:GET','',''),('新增房间护工职责','111','0,1,2,23,32,102,111','admin:gero:{gid}:areawork:add','','/gero/{id}/areawork:POST','',''),('修改房间护工职责','111','0,1,2,23,32,102,111','admin:gero:{gid}:areawork:update','','/gero/{id}/areawork/{id}:PUT','',''),('删除房间护工职责','111','0,1,2,23,32,102,111','admin:gero:{gid}:areawork:delete','','/gero/{id}/areawork/{id}:DELETE','',''),('护工模块','23','0,1,2,23','','','','',''),('查看项目','116','0,1,2,23,116','','no','','',''),('老人项目列表','117','0,1,2,23,116,117','carer:{cid}:gero:{gid}:care_item:read','','/gero/{id}/care_item:GET','',''),('老人专属项目列表','117','0,1,2,23,116,117','carer:{cid}:gero:{gid}:elder:care_item:read','','/gero/{id}/elder/{id}/care_item:GET','',''),('房间项目列表','117','0,1,2,23,116,117','carer:{cid}:gero:{gid}:area_item:read','','/gero/{id}/area_item:GET','',''),('查询老人项目','117','0,1,2,23,116,117','carer:{cid}:gero:{gid}:care_item:read','','/gero/{id}/care_item/{id}:GET','',''),('查询老人专属项目','117','0,1,2,23,116,117','carer:{cid}:gero:{gid}:elder:care_item:read','','/gero/{id}/elder/{id}/care_item/{id}:GET','',''),('查询房间项目','117','0,1,2,23,116,117','carer:{cid}:gero:{gid}:area_item:read','','/gero/{id}/area_item/{id}:GET','',''),('项目记录','116','0,1,2,23,116','','','','',''),('老人护工查看','124','0,1,2,23,116,124','carer:{cid}:gero:{gid}:carework_record:read','','/gero/{id}/carework_record','',''),('老人护工新增','124','0,1,2,23,116,124','carer:{cid}:gero:{gid}:carework_record:add','','/gero/{id}/carework_record','',''),('房间护工查看','124','0,1,2,23,116,124','carer:{cid}:gero:{gid}:areawork_record:read','','/gero/{id}/areawork_record','',''),('房间护工新增','124','0,1,2,23,116,124','carer:{cid}:gero:{gid}:areawork_record:add','','/gero/{id}/areawork_record','',''),('查看职责','116','0,1,2,23,116','','','','',''),('老人护工','129','0,1,2,23,116,129','carer:{cid}:gero:{gid}:duty_carer:read','','/gero/{id}/elder/{id}/duty_carer','',''),('房间护工','129','0,1,2,23,116,129','carer:{cid}:gero:{gid}:duty_carer:read','','/gero/{id}/area/{id}/duty_carer','',''),('医生模块','23','0,1,2,23','','no','','',''),('老人健康信息管理','132','0,1,2,23,132','','','','',''),('获取体温','133','0,1,2,23,132,133','doctor:gero:{gid}:elder:health:read','','/gero/{id}/elder/{id}/temperature:GET','',''),('新增体温','133','0,1,2,23,132,133','doctor:gero:{gid}:elder:health:add','','/gero/{id}/elder/{id}/temperature:POST','',''),('获取血压','133','0,1,2,23,132,133','doctor:gero:{gid}:elder:health:read','','/gero/{id}/elder/{id}/blood_pressure:GET','',''),('新增血压','133','0,1,2,23,132,133','doctor:gero:{gid}:elder:health:add','','/gero/{id}/elder/{id}/blood_pressure:POST','',''),('获取心率','133','0,1,2,23,132,133','doctor:gero:{gid}:elder:health:read','','/gero/{id}/elder/{id}/heart_rate:GET','',''),('新增心率','133','0,1,2,23,132,133','doctor:gero:{gid}:elder:health:add','','/gero/{id}/elder/{id}/heart_rate:POST','',''),('修改养老院老人密码','82','0,1,2,23,32,82','admin:gero:{gid}:staff:info:update','','/user/{id}/password:PUT','',''),('修改养老院职工密码','76','0,1,2,23,32,76','admin:gero:{gid}:elder:info:update','','/user/{id}/password:PUT','',''),('修改员工角色','67','0,1,2,23,32,67','admin:gero:{gid}:user:role:update','','/user/{id}/role:PUT','',''),('超级管理员','2','0,1,2','','','','',''),('查询用户列表','143','0,1,2,143','super:user:list:read','','/user:GET','',''),('修改上班时间安排','103','0,1,2,23,32,102,103','admin:gero:{gid}:schedule:add','','/gero/{id}/staff/{id}/schedule:POST','','')
go

insert into T_ROLE_PRIVILEGES(role_id,privilege_id) values(1,1),(1,2),(1,3),(1,4),(1,5),(1,6),(1,7),(1,8),(1,9),(1,10),(1,11),(1,12),(1,13),(1,14),(1,15),(1,16),(1,17),(1,18),(1,19),(1,20),(1,21),(1,22),(1,23),(1,24),(1,25),(1,26),(1,27),(1,28),(1,29),(1,30),(1,31),(1,32),(1,33),(1,34),(1,35),(1,36),(1,37),(1,38),(1,39),(1,40),(1,41),(1,42),(1,43),(1,44),(1,45),(1,46),(1,47),(1,48),(1,49),(1,50),(1,51),(1,52),(1,53),(1,54),(1,55),(1,56),(1,57),(1,58),(1,59),(1,60),(1,61),(1,62),(1,63),(1,64),(1,65),(1,66),(1,67),(1,68),(1,69),(1,70),(1,71),(1,72),(1,73),(1,74),(1,75),(1,76),(1,77),(1,78),(1,79),(1,80),(1,81),(1,82),(1,83),(1,84),(1,85),(1,86),(1,87),(1,88),(1,89),(1,90),(1,91),(1,92),(1,93),(1,94),(1,95),(1,96),(1,97),(1,98),(1,99),(1,100),(1,101),(1,102),(1,103),(1,104),(1,105),(1,106),(1,107),(1,108),(1,109),(1,110),(1,111),(1,112),(1,113),(1,114),(1,115),(1,116),(1,117),(1,118),(1,119),(1,120),(1,121),(1,122),(1,123),(1,124),(1,125),(1,126),(1,127),(1,128),(1,129),(1,130),(1,131),(1,132),(1,133),(1,134),(1,135),(1,136),(1,137),(1,138),(1,139),(1,140),(1,141),(1,142),(1,143),(1,144)
go

insert into T_ROLE_PRIVILEGES(role_id,privilege_id) values(2,1),(2,2),(2,3),(2,4),(2,5),(2,6),(2,7),(2,8),(2,9),(2,10),(2,11),(2,12),(2,13),(2,14),(2,15),(2,16),(2,17),(2,18),(2,19),(2,20),(2,21),(2,22),(2,23),(2,24),(2,25),(2,26),(2,27),(2,28),(2,29),(2,30),(2,31),(2,32),(2,33),(2,34),(2,35),(2,36),(2,37),(2,38),(2,39),(2,40),(2,41),(2,42),(2,43),(2,44),(2,45),(2,46),(2,47),(2,48),(2,49),(2,50),(2,51),(2,52),(2,53),(2,54),(2,55),(2,56),(2,57),(2,58),(2,59),(2,60),(2,61),(2,62),(2,63),(2,64),(2,65),(2,66),(2,67),(2,68),(2,69),(2,70),(2,71),(2,72),(2,73),(2,74),(2,75),(2,76),(2,77),(2,78),(2,79),(2,80),(2,81),(2,82),(2,83),(2,84),(2,85),(2,86),(2,87),(2,88),(2,89),(2,90),(2,91),(2,92),(2,93),(2,94),(2,95),(2,96),(2,97),(2,98),(2,99),(2,100),(2,101),(2,102),(2,103),(2,104),(2,105),(2,106),(2,107),(2,108),(2,109),(2,110),(2,111),(2,112),(2,113),(2,114),(2,115),(2,116),(2,117),(2,118),(2,119),(2,120),(2,121),(2,122),(2,123),(2,124),(2,125),(2,126),(2,127),(2,128),(2,129),(2,130),(2,131),(2,132),(2,133),(2,134),(2,135),(2,136),(2,137),(2,138),(2,139),(2,140),(2,141),(2,142),(2,143),(2,144)
go	
