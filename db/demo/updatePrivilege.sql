DROP TABLE T_ROLE_PRIVILEGES
GO

CREATE TABLE T_ROLE_PRIVILEGES
(
	id					int				PRIMARY KEY IDENTITY,
	role_id				int				NOT NULL,				--
	privilege_id		int				,						--
)
GO

DROP TABLE T_PRIVILEGE
go

CREATE TABLE T_PRIVILEGE
(
	id					int				PRIMARY KEY IDENTITY,
	name				nvarchar(50)	NOT NULL,				--权限名
	parent_id			int				NOT NULL,				--父亲结点，顶级菜单id为1，其父节点为虚拟结点，为0
	parent_ids			varchar(1000)	NOT NULL,				--所有父亲权限列表，用逗号分隔，从0开始。添加到索引
	permission			varchar(255)	NOT NULL,				--shiro权限字符串
	href				varchar(255)	,						--链接
	icon				varchar(100)	,						--图标
	notes				nvarchar(500)	,						--权限说明
)
GO

ALTER TABLE T_ROLE_PRIVILEGES
ADD CONSTRAINT fk_ROLE_PRIVILEGES_role_id
FOREIGN KEY (role_id)
REFERENCES T_ROLE(id)
ON DELETE CASCADE
GO

ALTER TABLE T_ROLE_PRIVILEGES
ADD CONSTRAINT fk_ROLE_PRIVILEGES_privilege_id
FOREIGN KEY (privilege_id)
REFERENCES T_PRIVILEGE(id)
ON DELETE CASCADE
GO

insert into T_PRIVILEGE(name,parent_id,parent_ids,permission,href,icon,notes)values('root',0,'0,','','','',''),('gero',1,'0,1,','','','',''),('staff',1,'0,1,','','','',''),('系统管理',2,'0,1,2,','','','',''),('用户管理',4,'0,1,2,4,','','','',''),('获取用户列表',5,'0,1,2,4,5,','/user#GET','/user','',''),('新增账户信息',5,'0,1,2,4,5,','/user#POST','','',''),('获取账户信息',5,'0,1,2,4,5,','/user/{id}#GET','/user/{id}','',''),('修改基本账户信息',5,'0,1,2,4,5,','/user/{id}#PUT','','',''),('修改用户密码',5,'0,1,2,4,5,','/user/{id}/password#PUT','','',''),('获取用户角色信息列表',5,'0,1,2,4,5,','/user/{id}/role#GET','/user/{id}/role','',''),('修改某个用户的角色',5,'0,1,2,4,5,','/user/{id}/role#PUT','','',''),('用户删除一个角色',5,'0,1,2,4,5,','/user/{id}/role/{id}#DELETE','','',''),('删除账户信息',5,'0,1,2,4,5,','/user/{id}#DELETE','','',''),('养老院的角色管理（管理员权限）',4,'0,1,2,4,','','','',''),('获取养老院角色列表',15,'0,1,2,4,15,','/gero/{id}/role#GET','/gero/{id}/role','',''),('新增养老院角色',15,'0,1,2,4,15,','/gero/{id}/role#POST','','',''),('角色信息',15,'0,1,2,4,15,','/gero/{id}/role/{id}#GET','/gero/{id}/role/{id}','',''),('修改角色的基本信息',15,'0,1,2,4,15,','/gero/{id}/role/{id}#PUT','','',''),('删除养老院角色',15,'0,1,2,4,15,','/gero/{id}/role/{id}#DELETE','','',''),('给养老院角色修改权限',15,'0,1,2,4,15,','/gero/{id}/role/{id}/privilege#PUT','','',''),('默认角色管理（超级管理员）',4,'0,1,2,4,','','','',''),('获取默认角色列表',22,'0,1,2,4,22,','/role#GET','/role','',''),('增加默认角色信息',22,'0,1,2,4,22,','/role#POST','','',''),('获取默认角色信息',22,'0,1,2,4,22,','/role/{id}#GET','/role/{id}','',''),('修改默认角色的信息',22,'0,1,2,4,22,','/role/{id}#PUT','','',''),('删除默认角色的信息',22,'0,1,2,4,22,','/role/{id}#DELETE','','',''),('修改默认角色的权限',22,'0,1,2,4,22,','/role/{id}/privilege#PUT','','',''),('权限管理(超级管理员)',4,'0,1,2,4,','','','',''),('权限列表',29,'0,1,2,4,29,','/privilege#GET','/privilege','',''),('新增权限',29,'0,1,2,4,29,','/privilege#POST','','',''),('修改权限',29,'0,1,2,4,29,','/privilege/{id}#PUT','','',''),('删除权限',29,'0,1,2,4,29,','/privilege/{id}#DELETE','','',''),('获取角色的权限',29,'0,1,2,4,29,','/role/{id}/privilege#GET','/role/{id}/privilege','',''),('养老院信息',2,'0,1,2,','','','',''),('养老院管理（超管）',35,'0,1,2,35,','','','',''),('获取养老院列表',36,'0,1,2,35,36,','/gero#GET','/gero','',''),('新增养老院基本信息',36,'0,1,2,35,36,','/gero#POST','','',''),('获取养老院基本信息',36,'0,1,2,35,36,','/gero/{id}#GET','/gero/{id}','',''),('修改养老院基本信息',36,'0,1,2,35,36,','/gero/{id}#PUT','','',''),('删除养老院',36,'0,1,2,35,36,','/gero/{id}#DELETE','','',''),('养老院区域管理',35,'0,1,2,35,','','','',''),('获取养老院所有的区域列表',42,'0,1,2,35,42,','/gero/{id}/area#GET','/gero/{id}/area','',''),('创建一个养老院区域',42,'0,1,2,35,42,','/gero/{id}/area#POST','','',''),('获取某区域及其子区域',42,'0,1,2,35,42,','/gero/{id}/area/{id}#GET','/gero/{id}/area/{id}','',''),('修改某区域',42,'0,1,2,35,42,','/gero/{id}/area/{id}#PUT','','',''),('修改某区域',42,'0,1,2,35,42,','/gero/{id}/area/{id}#DELETE','','',''),('养老院房间和床位',35,'0,1,2,35,','','','',''),('房间信息+老人',48,'0,1,2,35,48,','/room/{id}#GET','/room/{id}','',''),('默认老人项目（超管）',35,'0,1,2,35,','','','',''),('获取老人护理项目总表',50,'0,1,2,35,50,','/care_item#GET','/care_item','',''),('添加老人护理项目',50,'0,1,2,35,50,','/care_item#POST','','',''),('获取总表中某个老人项目',50,'0,1,2,35,50,','/care_item/{id}#GET','/care_item/{id}','',''),('修改总表中某个老人项目',50,'0,1,2,35,50,','/care_item/{id}#PUT','','',''),('删除总表中某个老人项目',50,'0,1,2,35,50,','/care_item/{id}#DELETE','','',''),('默认房间项目（超管）',35,'0,1,2,35,','','','',''),('获取房间项目总表',56,'0,1,2,35,56,','/area_item#GET','/area_item','',''),('添加房间项目',56,'0,1,2,35,56,','/area_item#POST','','',''),('获取总表中某个房间项目',56,'0,1,2,35,56,','/area_item/{id}#GET','/area_item/{id}','',''),('修改总表中房间项目',56,'0,1,2,35,56,','/area_item/{id}#PUT','','',''),('删除总表中某个房间项目',56,'0,1,2,35,56,','/area_item/{id}#DELETE','','',''),('养老院包含的老人项目',35,'0,1,2,35,','','','',''),('获取养老院护理项目列表',62,'0,1,2,35,62,','/gero/{id}/care_item#GET','/gero/{id}/care_item','',''),('添加养老院护理项目',62,'0,1,2,35,62,','/gero/{id}/care_item#POST','','',''),('获取某个养老院的老人项目',62,'0,1,2,35,62,','/gero/{id}/care_item/{id}#GET','/gero/{id}/care_item/{id}','',''),('修改某个养老院的老人项目',62,'0,1,2,35,62,','/gero/{id}/care_item/{id}#PUT','','',''),('删除养老院某个老人项目',62,'0,1,2,35,62,','/gero/{id}/care_item/{id}#DELETE','','',''),('养老院包含的房间项目',35,'0,1,2,35,','','','',''),('获取养老院房间项目列表',68,'0,1,2,35,68,','/gero/{id}/area_item#GET','/gero/{id}/area_item','',''),('添加养老院房间项目',68,'0,1,2,35,68,','/gero/{id}/area_item#POST','','',''),('获取养老院房间项目',68,'0,1,2,35,68,','/gero/{id}/area_item/{id}#GET','/gero/{id}/area_item/{id}','',''),('更新养老院房间项目',68,'0,1,2,35,68,','/gero/{id}/area_item/{id}#PUT','','',''),('删除养老院房间项目',68,'0,1,2,35,68,','/gero/{id}/area_item/{id}#DELETE','','',''),('老人相关',1,'0,1,','','','',''),('老人基本信息',74,'0,1,74,','','','',''),('获取老人列表',75,'0,1,74,75,','/gero/{id}/elder#GET','/gero/{id}/elder','',''),('增加老人详细信息',75,'0,1,74,75,','/gero/{id}/elder/#POST','','',''),('查单个老人详细信息',75,'0,1,74,75,','/gero/{id}/elder/{id}#GET','/gero/{id}/elder/{id}','',''),('修改单个老人详细信息',75,'0,1,74,75,','/gero/{id}/elder/{id}#PUT','','',''),('老人离院登记',75,'0,1,74,75,','/gero/{id}/elder/{id}#DELETE','','',''),('老人表单信息',74,'0,1,74,','','','',''),('表单',81,'0,1,74,81,','/elder/{id}/sheet#GET','/elder/{id}/sheet','',''),('老人健康数据',74,'0,1,74,','','','',''),('获取老人的体温数据',83,'0,1,74,83,','/elder/{id}/temperature#GET','/elder/{id}/temperature','',''),('输入老人的体温数据',83,'0,1,74,83,','/elder/{id}/temperature#POST','','',''),('获取老人的血压数据',83,'0,1,74,83,','/elder/{id}/blood_pressure#GET','/elder/{id}/blood_pressure','',''),('输入老人的血压数据',83,'0,1,74,83,','/elder/{id}/blood_pressure#POST','','',''),('获取老人的心率数据',83,'0,1,74,83,','/elder/{id}/heart_rate#GET','/elder/{id}/heart_rate','',''),('获取老人的心率数据',83,'0,1,74,83,','/elder/{id}/heart_rate#POST','','',''),('老人专属的项目',74,'0,1,74,','','','',''),('获取养老院老人的项目列表',90,'0,1,74,90,','/elder/{id}/care_item#GET','/elder/{id}/care_item','',''),('添加养老院某个老人的护理项目',90,'0,1,74,90,','/elder/{id}/care_item#POST','','',''),('获取老人的某个项目',90,'0,1,74,90,','/elder/{id}/care_item/{id}#GET','/elder/{id}/care_item/{id}','',''),('修改老人的某个项目',90,'0,1,74,90,','/elder/{id}/care_item/{id}#PUT','','',''),('删除老人某个项目',90,'0,1,74,90,','/elder/{id}/care_item/{id}#DELETE','','',''),('员工相关',3,'0,1,3,','','','',''),('员工基本信息',96,'0,1,3,96,','','','',''),('获取员工列表',97,'0,1,3,96,97,','/gero/{id}/staff#GET','/gero/{id}/staff','',''),('新增员工信息',97,'0,1,3,96,97,','/gero/{id}/staff#POST','','',''),('查询员工信息',97,'0,1,3,96,97,','/gero/{id}/staff/{id}#GET','/gero/{id}/staff/{id}','',''),('修改员工信息',97,'0,1,3,96,97,','/gero/{id}/staff/{id}#PUT','','',''),('员工离职',97,'0,1,3,96,97,','/gero/{id}/staff/{id}#DELETE','','',''),('老人护工的记录',96,'0,1,3,96,','','','',''),('获取老人护工负责的老人的项目记录列表',103,'0,1,3,96,103,','/carer/{id}/elder/{id}/records#GET','/carer/{id}/elder/{id}/records','',''),('添加老人护工负责的某个老人的项目记录',103,'0,1,3,96,103,','/carer/{id}/elder/{id}/records#POST','','',''),('获取老人护工的项目记录列表（所有老人）',103,'0,1,3,96,103,','/carer/{id}/elder/records#GET','/carer/{id}/elder/records','',''),('房间护工的房间记录',96,'0,1,3,96,','','','',''),('获取房间护工的房间项目记录列表',107,'0,1,3,96,107,','/carer/{id}/area/{id}/records#GET','/carer/{id}/area/{id}/records','',''),('添加房间护工的房间项目记录',107,'0,1,3,96,107,','/carer/{id}/area/{id}/records#POST','','',''),('获取房间护工的项目记录列表（所有房间）',107,'0,1,3,96,107,','/carer/{id}/area/records#GET','/carer/{id}/area/records','',''),('排班相关',3,'0,1,3,','','','',''),('职工上班时间安排（单个员工维度）',111,'0,1,3,111,','','','',''),('获取某员工的上班信息列表（批量）',112,'0,1,3,111,112,','/staff/{id}/schedule#GET','/staff/{id}/schedule','',''),('添加员工的排班信息（批量）',112,'0,1,3,111,112,','/staff/{id}/schedule#POST(PUT)','','',''),('获取某员工的某天是否上班',112,'0,1,3,111,112,','/staff/{id}/schedule/{date}#GET','/staff/{id}/schedule/{date}','',''),('增加/修改员工的某一天排班信息',112,'0,1,3,111,112,','/staff/{id}/schedule/{date}#POST(PUT)','','',''),('删除员工的某一天排班信息',112,'0,1,3,111,112,','/staff/{id}/schedule/{date}#DELETE','','',''),('职工上排时间安排（养老院维度）',111,'0,1,3,111,','','','',''),('获取养老院员工排班信息',118,'0,1,3,111,118,','/gero/{id}/schedule#GET','/gero/{id}/schedule','',''),('修改养老院护工排班信息(多员工)',118,'0,1,3,111,118,','/gero/{id}/schedule#PUT','','',''),('老人护工职责',111,'0,1,3,111,','','','',''),('获取老人护工负责的老人列表',121,'0,1,3,111,121,','/carer/{id}/elder#GET','/carer/{id}/elder','',''),('获取老人护工负责的某个老人的相关信息',121,'0,1,3,111,121,','/carer/{id}/elder/{id}/duty#GET','/carer/{id}/elder/{id}/duty','',''),('终止老人护工对某个老人的负责关系',121,'0,1,3,111,121,','/carer/{id}/elder/{id}/duty#DELETE','','',''),('建立老人护工对某个老人的负责关系，同时终止这个老人与其他护工的负责关系',121,'0,1,3,111,121,','/carer/{id}/elder/{id}/duty#PUT','','',''),('房间护工职责',111,'0,1,3,111,','','','',''),('获取房间护工负责的房间列表',126,'0,1,3,111,126,','/carer/{id}/area#GET','/carer/{id}/area','',''),('获取房间护工负责的某个房间的相关信息',126,'0,1,3,111,126,','/carer/{id}/area/{id}/duty#GET','/carer/{id}/area/{id}/duty','',''),('终止房间护工对某个房间的负责关系',126,'0,1,3,111,126,','/carer/{id}/area/{id}/duty#DELETE','','',''),('建立房间护工对某个房间的负责关系',126,'0,1,3,111,126,','/carer/{id}/area/{id}/duty#POST','','',''),('建立房间护工对某个房间的负责关系，同时终止这个房间与其他护工的负责关系',126,'0,1,3,111,126,','/carer/{id}/area/{id}/duty#PUT','','',''),('排班结果',111,'0,1,3,111,','','','',''),('获取老人的负责护工',132,'0,1,3,111,132,','/elder/{id}/duty_carer#GET','/elder/{id}/duty_carer','',''),('获取房间的负责护工',132,'0,1,3,111,132,','/area/{id}/duty_carer#GET','/area/{id}/duty_carer','','')
go

insert into T_ROLE_PRIVILEGES(role_id,privilege_id) values(1,1),(1,2),(1,3),(1,4),(1,5),(1,6),(1,7),(1,8),(1,9),(1,10),(1,11),(1,12),(1,13),(1,14),(1,15),(1,16),(1,17),(1,18),(1,19),(1,20),(1,21),(1,22),(1,23),(1,24),(1,25),(1,26),(1,27),(1,28),(1,29),(1,30),(1,31),(1,32),(1,33),(1,34),(1,35),(1,36),(1,37),(1,38),(1,39),(1,40),(1,41),(1,42),(1,43),(1,44),(1,45),(1,46),(1,47),(1,48),(1,49),(1,50),(1,51),(1,52),(1,53),(1,54),(1,55),(1,56),(1,57),(1,58),(1,59),(1,60),(1,61),(1,62),(1,63),(1,64),(1,65),(1,66),(1,67),(1,68),(1,69),(1,70),(1,71),(1,72),(1,73),(1,74),(1,75),(1,76),(1,77),(1,78),(1,79),(1,80),(1,81),(1,82),(1,83),(1,84),(1,85),(1,86),(1,87),(1,88),(1,89),(1,90),(1,91),(1,92),(1,93),(1,94),(1,95),(1,96),(1,97),(1,98),(1,99),(1,100),(1,101),(1,102),(1,103),(1,104),(1,105),(1,106),(1,107),(1,108),(1,109),(1,110),(1,111),(1,112),(1,113),(1,114),(1,115),(1,116),(1,117),(1,118),(1,119),(1,120),(1,121),(1,122),(1,123),(1,124),(1,125),(1,126),(1,127),(1,128),(1,129),(1,130),(1,131),(1,132),(1,133),(1,134)
go

insert into T_ROLE_PRIVILEGES(role_id,privilege_id) values(2,1),(2,2),(2,3),(2,4),(2,5),(2,6),(2,7),(2,8),(2,9),(2,10),(2,11),(2,12),(2,13),(2,14),(2,15),(2,16),(2,17),(2,18),(2,19),(2,20),(2,21),(2,22),(2,23),(2,24),(2,25),(2,26),(2,27),(2,28),(2,29),(2,30),(2,31),(2,32),(2,33),(2,34),(2,35),(2,36),(2,37),(2,38),(2,39),(2,40),(2,41),(2,42),(2,43),(2,44),(2,45),(2,46),(2,47),(2,48),(2,49),(2,50),(2,51),(2,52),(2,53),(2,54),(2,55),(2,56),(2,57),(2,58),(2,59),(2,60),(2,61),(2,62),(2,63),(2,64),(2,65),(2,66),(2,67),(2,68),(2,69),(2,70),(2,71),(2,72),(2,73),(2,74),(2,75),(2,76),(2,77),(2,78),(2,79),(2,80),(2,81),(2,82),(2,83),(2,84),(2,85),(2,86),(2,87),(2,88),(2,89),(2,90),(2,91),(2,92),(2,93),(2,94),(2,95),(2,96),(2,97),(2,98),(2,99),(2,100),(2,101),(2,102),(2,103),(2,104),(2,105),(2,106),(2,107),(2,108),(2,109),(2,110),(2,111),(2,112),(2,113),(2,114),(2,115),(2,116),(2,117),(2,118),(2,119),(2,120),(2,121),(2,122),(2,123),(2,124),(2,125),(2,126),(2,127),(2,128),(2,129),(2,130),(2,131),(2,132),(2,133),(2,134)
go	
